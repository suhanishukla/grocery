<!DOCTYPE html>
<html>

<head>
  
</head>
<body>
{% include 'nav_bar.html' %}
<h2 class="text-center">Shopping Cart</h2>

<table id="shoppingCart" class="table round-table">
  <thead>
    <tr>
      <th scope="col">Category</th>
      <th scope="col">Item Name</th>
      <th scope="col">Price</th>
      <th scope="col">Delete Item</th>
    </tr>
  </thead>
  <tbody id="zen">
    <!-- <tr>
      <td colspan= "row">Hi</th>
      <td colspan="1">Example</td>
      <td colspan="1">Test</td>
      <td colspan="1"><button>Delete Item</button></td>
    </tr> -->
  </tbody>
</table>
<button onclick="clearEverything()"class="btn btn-primary">Clear All Items</button>

<script>
  var keys = Object.keys(sessionStorage).sort();
  keys.forEach(function(key) {

    var storedItem = JSON.parse(sessionStorage.getItem(key))
    
    var newRow = document.createElement('tr');
    newRow.id = key.toString();
    
    var price = document.createElement('td');
    var name1 = document.createElement('td');
    var cat = document.createElement('td');
    var deleteRows = document.createElement('td');

    var deleteButton = document.createElement('button');
    deleteButton.textContent = "Delete Item"
    deleteButton.setAttribute('onclick', `deleteItem(${newRow.id})`);
    deleteButton.setAttribute('class', `btn btn-primary`);

    deleteRows.appendChild(deleteButton)


    price.textContent = storedItem[0];
    name1.textContent = storedItem[1];
    cat.textContent = storedItem[2];
    
    newRow.appendChild(price);
    newRow.appendChild(name1);
    newRow.appendChild(cat);
    newRow.appendChild(deleteRows);

    document.querySelector('#shoppingCart tbody').appendChild(newRow);
  });

  function clearEverything()
  {
    sessionStorage.clear();
    var table = document.getElementById("zen");
    while (table.rows.length >= 0) {
      table.deleteRow(1);
      //fix this it only deletes everything but the first row
    }
  }

  function deleteItem(row_id)
  {
    items = row_id.id
    sessionStorage.removeItem(items)
    document.getElementById(items).remove()
  }

</script>

</body>
</html>